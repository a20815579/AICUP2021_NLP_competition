# 基於bert的醫病決策判斷與問答
## 簡介
- 為教育部人工智慧共創平台 AICUP2021 之 NLP競賽
- 競賽網址：https://aidea-web.tw/topic/3665319f-cd5d-4f92-8902-00ebbd8e871d
- 有兩個預測任務：（1）決策預判與風險評估 （2）醫病問答
## 資料前處理
### 風險評估
1.	先以結巴斷詞，移除「的」
2.	將英文字母大寫轉小寫，全型轉半型
3.	使用re和pandas的replace，移除冗字和統一類似字詞
4.	移除經過處理長度仍超過3000字的文章（代表內容太冗缺乏重點，為避免給模型造成過多雜訊，將之移除）
5.	將文章切成每段510字，前後50字會和相鄰資料重疊
6.	移除長度小於50字的資料（代表內容在前一筆資料已經有(因為前後會overlap 50字)，因此刪除）  
### 醫病問答
除了以上前處理外，加上以下作法：
- 關鍵字句提取  
使用jieba之TF-IDF，從問題與選項中提取需要的關鍵字，大幅縮減文章篇幅，使模型得以精準學習。
- 題目分類  
問答題目主要可分為兩種：  
(1) 在三個選項內選擇正確的選項 (下列何者正確)  
(2) 在三個選項內選擇錯誤的選項 (下列何者錯誤)  
將兩種問題分開訓練模型，使模型預測更為正確。
## 模型訓練
### 風險評估
- 參數說明
    - 模型選用BertForSequenceClassification
    - batch_size=4
    - gradient_accumulation_steps = 8
    - learning_rate = 3e-5
- 流程說明
    - 載入測試資料至訓練好的模型進行預測
    - 對預測結果取 softmax（配合題目要求輸出為機率值）
    - 將同一筆文章不同片段的預測結果取平均，作為該文章的預測值
### 醫病問答
- 模型選用BertForMultipleChoice
- 針對兩類問題訓練兩種模型
- 其他參數與風險評估相同
## 環境
使用Google Colab進行訓練
## 結果
最後我們在正式的排名中為28/81，為前標隊伍，並獲得計畫辦公室之獎狀  
  
![image](https://i.imgur.com/B1BIuGP.jpg)
